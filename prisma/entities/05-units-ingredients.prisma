/// ========== UNITS & INGREDIENTS ==========
model Unit {
  id           Int    @id @default(autoincrement())
  deletedAt DateTime? @map("deleted_at")
  name         String @unique
  abbreviation String @unique

  ingredients      Ingredient[]
  placeStocks      PlaceStock[]
  goodsReceiptItems GoodsReceiptItem[]

  @@map("units")
}

model Ingredient {
  id    Int     @id @default(autoincrement())
  deletedAt DateTime? @map("deleted_at")
  name  String
  sku   String?
  unitId Int    @map("unit_id")
  categoryId Int? @map("category_id")

  unit               Unit              @relation(fields: [unitId], references: [id], onDelete: Restrict)
  category           Category? @relation(fields: [categoryId], references: [id], onDelete: SetNull)
  recipes            Recipe[]
  placeStocks        PlaceStock[]
  supplierProducts   SupplierProduct[]
  ingredientPackages IngredientPackage[]
  stockTransfers     StockTransfer[]
  wastes             Waste[]
  inventoryStockDaily InventoryStockDaily[]

  @@map("ingredients")
}

model Recipe {
  id           Int     @id @default(autoincrement())
  deletedAt DateTime? @map("deleted_at")
  menuId       Int     @map("menu_id")
  ingredientId Int     @map("ingredient_id")
  menuVariantItemId Int? @map("menu_variant_item_id")
  qty          Decimal @db.Decimal(12, 2)

  menu       Menu       @relation(fields: [menuId], references: [id], onDelete: Cascade)
  ingredient Ingredient @relation(fields: [ingredientId], references: [id], onDelete: Restrict)
  menuVariantItem MenuVariantItem? @relation(fields: [menuVariantItemId], references: [id], onDelete: Cascade)

  @@unique([menuId, menuVariantItemId, ingredientId])
  @@map("recipes")
}
