/// ========== MENUS ==========
model Menu {
  id          Int      @id @default(autoincrement())
  deletedAt DateTime? @map("deleted_at")
  placeId     Int?     @map("place_id")
  name        String
  categoryId  Int?     @map("category_id")
  description String?
  sku         String?
  isActive    Boolean  @default(true) @map("is_active")
  createdAt   DateTime @default(now()) @map("created_at")

  place     Place?    @relation(fields: [placeId], references: [id], onDelete: SetNull)
  category  Category? @relation(fields: [categoryId], references: [id], onDelete: SetNull)
  variants  MenuVariant[]
  prices    MenuPrice[]
  recipes   Recipe[]
  transactionItems TransactionItem[]

  @@map("menus")
}

model Category {
  id   Int    @id @default(autoincrement())
  deletedAt DateTime? @map("deleted_at")
  name String @unique

  menus Menu[]

  @@map("categories")
}

model MenuVariant {
  id     Int @id @default(autoincrement())
  deletedAt DateTime? @map("deleted_at")
  menuId Int @map("menu_id")
  name   String

  menu Menu @relation(fields: [menuId], references: [id], onDelete: Cascade)
  items MenuVariantItem[]
  transactionItemVariants TransactionItemVariant[]

  @@map("menu_variants")
}

model MenuPrice {
  id        Int      @id @default(autoincrement())
  deletedAt DateTime? @map("deleted_at")
  menuId    Int      @map("menu_id")
  price     Decimal  @db.Decimal(12, 2)
  effectiveDate DateTime @map("effective_date") @db.Date

  menu Menu @relation(fields: [menuId], references: [id], onDelete: Cascade)

  @@map("menu_prices")
}

model MenuVariantItem {
  id             Int     @id @default(autoincrement())
  deletedAt DateTime? @map("deleted_at")
  menuVariantId  Int     @map("menu_variant_id")
  name           String
  additionalPrice Decimal @db.Decimal(12, 2) @default(0) @map("additional_price")

  menuVariant MenuVariant @relation(fields: [menuVariantId], references: [id], onDelete: Cascade)
  recipes Recipe[]

  @@map("menu_variant_items")
}
