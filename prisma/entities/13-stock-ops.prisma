/// ========== STOCK OPS ==========
model StockTransfer {
  id           Int     @id @default(autoincrement())
  deletedAt DateTime? @map("deleted_at")
  ingredientId Int     @map("ingredient_id")
  fromPlaceId Int?    @map("from_place_id")
  toPlaceId   Int?    @map("to_place_id")
  qty          Decimal @db.Decimal(12, 2)
  createdAt    DateTime @default(now()) @map("created_at")

  ingredient Ingredient @relation(fields: [ingredientId], references: [id], onDelete: Restrict)
  fromPlace  Place?    @relation("StockTransferFrom", fields: [fromPlaceId], references: [id], onDelete: SetNull)
  toPlace    Place?    @relation("StockTransferTo", fields: [toPlaceId], references: [id], onDelete: SetNull)

  @@map("stock_transfers")
}

model Waste {
  id          Int     @id @default(autoincrement())
  deletedAt DateTime? @map("deleted_at")
  ingredientId Int   @map("ingredient_id")
  placeId    Int?   @map("place_id")
  qty         Decimal @db.Decimal(12, 2)
  reason      String?
  createdAt   DateTime @default(now()) @map("created_at")

  ingredient Ingredient @relation(fields: [ingredientId], references: [id], onDelete: Restrict)
  place     Place?    @relation(fields: [placeId], references: [id], onDelete: SetNull)

  @@map("wastes")
}

model InventoryStockDaily {
  id           Int     @id @default(autoincrement())
  deletedAt DateTime? @map("deleted_at")
  placeId      Int     @map("place_id")
  ingredientId Int     @map("ingredient_id")
  date         DateTime @db.Date
  openingQty   Decimal  @db.Decimal(12, 2) @default(0) @map("opening_qty")
  closingQty   Decimal  @db.Decimal(12, 2) @default(0) @map("closing_qty")
  diffQty      Decimal? @db.Decimal(12, 2) @map("diff_qty")
  createdAt    DateTime @default(now()) @map("created_at")

  place      Place      @relation(fields: [placeId], references: [id], onDelete: Restrict)
  ingredient Ingredient @relation(fields: [ingredientId], references: [id], onDelete: Restrict)

  @@unique([placeId, ingredientId, date])
  @@map("inventory_stock_daily")
}
